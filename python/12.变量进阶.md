# 变量进阶

## 01.变量的引用

- **变量** 和 **数据** 都是保存在 **内存** 中的
- 在 Python 中 **函数 的 参数传递** 以及 **返回值** 都是靠 **引用** 传递的

### 1.1 引用的概念

在 python 中

- **变量** 和 **数据** 是分开存储的

- **数据** 保存在内存中的一个位置，数据的地址本质上是 **数字**

- **变量** 中保存 数据 在内存中的地址

- **变量** 中 **记录数据的地址**，就叫做引用

- 使用 id( ) 函数可以查看变量中保存数据所在的 **内存地址**

  **注意**：如果变量已经被定义，当给一个变量赋值的时候，本质上是 **修改了数据的引用**

  - 变量 **不再** 对之前的数据引用
  - 变量 **改为** 为新赋值的数据引用 

### 1.2 变量引用 的示例

### 1.3 函数的参数和返回值的传递

- Python 中，函数的 **实参/返回值** 都是靠 **引用** 来传递的
- 变量返回，返回的是数据的引用，而不是数据本身

## 02.可变和不可变类型

- **不可变类型**，内存中的数据不允许被接收：

  - 数字类型：int，bool，float，complex，long(2.x)
  - 字符串：str
  - 元组：tuple

- **可变类型**，内存中的数据可以被修改：

  - 列表：list

  - 字典：dict

    注意：字典的 key **只能使用不可变类型的数据**

**注意**

1. 可变类型的数据变化，是通过 **方法** 来实现的
2. 如果给一个可变类型的变量，赋值了一个新的数据，**引用会修改**
   - 变量 **不再** 对之前的数据引用
   - 变量 **改为** 为新赋值的数据引用 

#### 哈希（hash）

- Python 中内置 hash(o) 的函数
  - 接收一个 **不可变类型** 的数据作为 **参数**
  - **返回** 结果是一个 **整数**
- 哈希 是一种 **算法**，其作用为 提取数据的 **特征码（指纹）**
  - **相同的内容** 得到 **相同的内容**
  - **不同的内容** 得到 **不同的内容**
- 在 Python 中，设置字典的 **键值对** 时，会首先对 key 进行 hash 以决定如何在内存中保存字典的数据，以便 **后续** 对字典的操作：**增、删、改、查**
  - 键值对的 key 必须是不可变类型数据
  - 键值对的 value 可以是任意类型的数据

## 03.局部变量和全局变量

- **局部变量** 是在 **函数内部** 定义的变量，**只能在函数内部使用**

- **全局变量** 是在 **函数外部定义** 的变量（没有定义在某一个函数内），**所有函数** 内部 **都可以使用这个变量**

  提示：在其他的开发语言中，**不推荐使用全局变量** -- 可变范围太大，导致程序不好维护！！！

### 3.1 局部变量

- **局部变量** 是在 **函数内部** 定义的变量，**只能在函数内部使用**
- 函数执行结束后，**函数内部的局部变量，会被系统回收**
- 不同的函数，可以定义相同的名字的局部变量，但是各用各的，不会产生影响

**局部变量的作用**

- 在函数内部使用，**临时** 保存 **函数内部需要使用的数据**

**局部变量的生命周期**

- **生命周期** 就是变量从 **被创建** 到 **被系统回收** 的过程
- **局部变量** 在 **函数执行时** 才会被创建
- **函数执行结束后** 局部变量 被系统回收
- **局部变量在生命周期** 内，可以用来存储 **函数内部临时使用到的数据**

### 3.2 全局变量

- **全局变量** 是在 **函数外部定义** 的变量，所有函数内部都可以使用这个变量

**注意：**函数执行时，**需要处理变量时** 会：

1. **首先** 查找 **函数内部** 是否存在 **指定名称 的局部变量，如果有，直接使用**
2. 如果没有，查找 **函数外部** 是否存在 **指定名称 的全局变量，如果有，直接使用**
3. 如果还没有，程序报错！！！

**1）函数不能直接修改 全局变量的引用**

- **全局变量** 是在 **函数外部定义** 的变量（没有定义在某一个函数内），**所有函数** 内部 **都可以使用这个变量**

  提示：在其他的开发语言中，**不推荐使用全局变量** -- 可变范围太大，导致程序不好维护！！！

- 在函数内部，可以 **通过全局变量的引用获取对应的数据**

- **不允许直接修改全局变量的引用** —— 使用赋值语句修改全局变量的值

  注意：只是在函数内部定义了一个局部变量，只是变量名相同 —— 在函数内部不能直接修改全局变量的值

**2）在函数内部修改全局变量的值**

- 如果在函数中需要修改全局变量，需要使用 global 进行声明

**3）全局变量定义的位置**

- 为了保证所有的函数都能够正确使用到全局变量，应该 **将全局变量定义在其他函数的上方**

**注意**

- 全局变量在调用函数之后才定义，在执行函数时，变量还没有定义，程序会报错！！！

**代码结构示意图如下**

| shebang（标识要用的解释器） |
| :-------------------------: |
|       **import 模块**       |
|        **全局变量**         |
|        **函数定义**         |
|        **执行代码**         |

**4）全局变量命名的建议**

- 为了避免局部变量和全局变量出现混淆，在定义全局变量时，全局变量名前应该增加 g_ 或者 gl_ 的前缀